""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
Recupera de la tabla de trips todos los viajes que comenzaron en el Loop (pickup_location_id: 50) 
el sábado y terminaron en O'Hare (dropoff_location_id: 63). Obtén las condiciones climáticas para 
cada viaje. 
Recupera también la duración de cada viaje. 
Ignora los viajes para los que no hay datos disponibles sobre las condiciones climáticas.

Las columnas de la tabla deben estar en el siguiente orden:

start_ts
weather_conditions
duration_seconds
Ordena por trip_id.
"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""



SELECT
   
   start_ts,
    CASE 
        WHEN weather_records.description LIKE '%rain%' 
        OR weather_records.description LIKE '%storm%'
        THEN 'Bad' ELSE 'Good'
    END AS weather_conditions,
    duration_seconds
FROM
    trips
    INNER JOIN weather_records ON weather_records.ts = trips.start_ts
WHERE
    pickup_location_id = 50 AND
    dropoff_location_id = 63 AND
    EXTRACT('isodow' from start_ts) = 6
    
ORDER BY
    trip_id;


Resultado

start_ts	weather_conditions	duration_seconds
2017-11-25 12:00:00	Good	1380
2017-11-25 16:00:00	Good	2410
2017-11-25 14:00:00	Good	1920
2017-11-25 12:00:00	Good	1543
2017-11-04 10:00:00	Good	2512
2017-11-11 07:00:00	Good	1440
2017-11-11 04:00:00	Good	1320
2017-11-04 16:00:00	Bad	2969
2017-11-18 11:00:00	Good	2280
2017-11-04 16:00:00	Bad	3120
2017-11-11 15:00:00	Good	4800
2017-11-04 05:00:00	Good	1260
2017-11-11 06:00:00	Good	1346
2017-11-04 04:00:00	Good	1333
2017-11-04 11:00:00	Good	2574
2017-11-11 12:00:00	Good	2441
2017-11-04 14:00:00	Good	3300
2017-11-11 14:00:00	Good	2460
2017-11-11 12:00:00	Good	2040
2017-11-18 06:00:00	Good	1500
2017-11-04 11:00:00	Good	2040
2017-11-11 08:00:00	Good	1470
2017-11-04 08:00:00	Good	1546
2017-11-11 16:00:00	Good	2100
2017-11-25 13:00:00	Good	60
2017-11-04 12:00:00	Good	2640
2017-11-25 10:00:00	Good	1502
2017-11-11 12:00:00	Good	1915
2017-11-04 12:00:00	Good	2769
2017-11-11 13:00:00	Good	2250
2017-11-11 04:00:00	Good	1260
2017-11-18 14:00:00	Good	2826
2017-11-04 14:00:00	Good	3360
2017-11-04 14:00:00	Good	3180
2017-11-25 20:00:00	Good	2100
2017-11-04 10:00:00	Good	1800
2017-11-11 12:00:00	Good	2289
2017-11-04 08:00:00	Good	1494
2017-11-11 11:00:00	Good	1560
2017-11-18 12:00:00	Bad	1980
2017-11-11 13:00:00	Good	2115
2017-11-11 10:00:00	Good	1506
2017-11-04 12:00:00	Good	2580
2017-11-04 17:00:00	Bad	2460
2017-11-11 09:00:00	Good	1620
2017-11-04 06:00:00	Good	1163
2017-11-04 05:00:00	Good	1533
2017-11-11 04:00:00	Good	1477
2017-11-11 19:00:00	Good	1984
2017-11-04 13:00:00	Good	2940
2017-11-04 07:00:00	Good	1320
2017-11-04 06:00:00	Good	1440
2017-11-11 06:00:00	Good	1260
2017-11-11 08:00:00	Good	1560
2017-11-04 09:00:00	Good	1683
2017-11-11 05:00:00	Good	1343
2017-11-18 06:00:00	Good	1742
2017-11-04 09:00:00	Good	1560
2017-11-11 08:00:00	Good	1358
2017-11-11 12:00:00	Good	1980
2017-11-04 16:00:00	Bad	2760
2017-11-18 12:00:00	Bad	2460
2017-11-18 10:00:00	Bad	1440
2017-11-25 14:00:00	Good	1620
2017-11-11 08:00:00	Good	1415
2017-11-25 05:00:00	Good	1325
2017-11-18 06:00:00	Good	2100
2017-11-11 08:00:00	Good	1320
2017-11-11 10:00:00	Good	1260
2017-11-11 06:00:00	Good	1260
2017-11-11 08:00:00	Good	1200
2017-11-25 08:00:00	Good	1320
2017-11-11 18:00:00	Good	2280
2017-11-25 10:00:00	Good	1320
2017-11-04 06:00:00	Good	1140
2017-11-11 18:00:00	Good	2520
2017-11-18 16:00:00	Bad	3000
2017-11-11 19:00:00	Good	1920
2017-11-04 18:00:00	Bad	2363
2017-11-04 14:00:00	Good	3084
2017-11-11 08:00:00	Good	1380
2017-11-11 08:00:00	Good	1380
2017-11-04 09:00:00	Good	1380
2017-11-04 09:00:00	Good	1380
2017-11-11 12:00:00	Good	2213
2017-11-11 08:00:00	Good	1140
2017-11-11 10:00:00	Good	1435
2017-11-04 10:00:00	Good	2460
2017-11-11 07:00:00	Good	1200
2017-11-04 15:00:00	Good	3201
2017-11-11 11:00:00	Good	2074
2017-11-18 11:00:00	Good	2843
2017-11-11 17:00:00	Good	2426
2017-11-04 09:00:00	Good	1740
2017-11-25 07:00:00	Good	2340
2017-11-18 05:00:00	Good	2075
2017-11-18 07:00:00	Bad	1511
2017-11-11 18:00:00	Good	2220
2017-11-04 10:00:00	Good	2551
2017-11-11 16:00:00	Good	2062
2017-11-04 12:00:00	Good	2999
2017-11-04 08:00:00	Good	1677
2017-11-04 06:00:00	Good	1177
2017-11-11 06:00:00	Good	1475
2017-11-25 08:00:00	Good	1277
2017-11-11 04:00:00	Good	1213
2017-11-18 13:00:00	Bad	4044
2017-11-04 21:00:00	Good	1680
2017-11-04 18:00:00	Bad	1980
2017-11-25 18:00:00	Good	2760
2017-11-11 09:00:00	Good	1380
2017-11-11 07:00:00	Good	1380
2017-11-18 08:00:00	Bad	1320
2017-11-11 16:00:00	Good	2591
2017-11-11 08:00:00	Good	1260
2017-11-11 07:00:00	Good	1380
2017-11-11 10:00:00	Good	1440
2017-11-04 14:00:00	Good	3240
2017-11-04 16:00:00	Bad	2782
2017-11-04 14:00:00	Good	3120
2017-11-04 19:00:00	Good	1869
2017-11-11 06:00:00	Good	1218
2017-11-11 11:00:00	Good	1620
2017-11-11 10:00:00	Good	1380
2017-11-11 08:00:00	Good	1380
2017-11-11 09:00:00	Good	1380
2017-11-11 07:00:00	Good	1320
2017-11-04 14:00:00	Good	3300
2017-11-04 13:00:00	Good	3060
2017-11-11 13:00:00	Good	2100
2017-11-18 14:00:00	Good	3540
2017-11-11 21:00:00	Good	1920
2017-11-11 17:00:00	Good	2160
2017-11-11 13:00:00	Good	2123
2017-11-11 07:00:00	Good	1384
2017-11-11 10:00:00	Good	1260
2017-11-18 15:00:00	Good	3480
2017-11-11 12:00:00	Good	2071
2017-11-18 13:00:00	Bad	3300
2017-11-25 13:00:00	Good	1560
2017-11-04 12:00:00	Good	2760
2017-11-18 12:00:00	Bad	3024
2017-11-11 11:00:00	Good	1380
2017-11-25 06:00:00	Good	1200
2017-11-11 06:00:00	Good	1667
2017-11-18 18:00:00	Good	2056
2017-11-11 10:00:00	Good	1473
2017-11-11 17:00:00	Good	2460
2017-11-11 10:00:00	Good	1740
2017-11-11 14:00:00	Good	2340
2017-11-04 16:00:00	Bad	3180
2017-11-04 11:00:00	Good	2220
2017-11-11 12:00:00	Good	2240
2017-11-04 14:00:00	Good	2778
2017-11-18 06:00:00	Good	1420
2017-11-04 14:00:00	Good	3480
2017-11-25 20:00:00	Good	1980
2017-11-18 10:00:00	Bad	2055
2017-11-11 15:00:00	Good	2380
2017-11-04 08:00:00	Good	1539
2017-11-25 10:00:00	Good	1591
2017-11-18 14:00:00	Good	2588
2017-11-11 07:00:00	Good	0
2017-11-04 22:00:00	Good	1380
2017-11-04 12:00:00	Good	2220
2017-11-04 08:00:00	Good	1380
2017-11-04 14:00:00	Good	2820
2017-11-11 09:00:00	Good	0
2017-11-18 09:00:00	Bad	1260
2017-11-18 13:00:00	Bad	2940
2017-11-18 16:00:00	Bad	2340
2017-11-18 12:00:00	Bad	2220
2017-11-25 11:00:00	Good	1140
2017-11-11 10:00:00	Good	1239
2017-11-04 16:00:00	Bad	3130
2017-11-18 15:00:00	Good	2877
2017-11-11 03:00:00	Good	1162
2017-11-04 14:00:00	Good	3060
2017-11-11 13:00:00	Good	1680
2017-11-04 10:00:00	Good	2112
2017-11-04 11:00:00	Good	2328
2017-11-11 05:00:00	Good	1504
2017-11-04 06:00:00	Good	1439
2017-11-18 16:00:00	Bad	2811
2017-11-18 11:00:00	Good	2094
2017-11-11 06:00:00	Good	1430
2017-11-18 12:00:00	Bad	3026
2017-11-04 14:00:00	Good	3120
2017-11-25 12:00:00	Good	1380
2017-11-18 14:00:00	Good	2994
2017-11-11 11:00:00	Good	1620
2017-11-04 12:00:00	Good	2640
2017-11-18 00:00:00	Bad	480
2017-11-18 19:00:00	Good	0
2017-11-11 10:00:00	Good	1414
2017-11-11 12:00:00	Good	1981
2017-11-11 08:00:00	Good	1200
2017-11-04 11:00:00	Good	2160
2017-11-11 15:00:00	Good	2400
2017-11-11 20:00:00	Good	1500


